<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <title>天氣小工具</title>
    <meta
      name="description"
      content="自動偵測所在縣市並顯示台灣各地 36 小時天氣預報，支援手動切換縣市的簡易查詢工具。"
    />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="app-container">
      <div class="layout">
        <!-- 左側：控制＋天氣資訊 -->
        <div class="left-pane">
          <h1>目前地點天氣</h1>
          <div class="subtitle">
            自動偵測你目前位置，抓出距離最近的縣市，幫你查 36 小時內的天氣預報。
          </div>

          <div id="status">正在取得您的位置...</div>
          <div id="location"></div>

          <div class="controls">
            <label for="citySelect">縣市</label>
            <select id="citySelect">
              <option value="">載入中...</option>
            </select>
          </div>

          <div class="hint">
            預設會用你的定位找最近的縣市，你也可以自己改選上方縣市下拉選單，
            右邊地圖會同步變色。
          </div>

          <!-- 今天概況小卡（關掉浮窗後會常駐） -->
          <div id="summaryCard" class="summary-card hidden"></div>

          <!-- 天氣詳情卡片 -->
          <div id="weather" class="card" style="margin-top: 16px;"></div>

          <p class="source-note">
  本頁面所示之天氣預報資料係引用自
  <a href="https://opendata.cwa.gov.tw/index" target="_blank" rel="noopener noreferrer">
    中央氣象署-開放資料平臺
  </a>
  所提供之開放資料，相關資訊仍以中央氣象署網站公告內容為準。
</p>
        </div>

        <!-- 右側：台灣地圖（D3 + GeoJSON） -->
        <div class="map-panel">
          <div class="map-title-row">
            <div class="map-title">台灣地圖</div>
          </div>

          <div id="taiwanMap" class="map-box">
            <!-- D3 會畫在這個 SVG 裡 -->
            <svg
              id="taiwanSvg"
              xmlns="http://www.w3.org/2000/svg"
              preserveAspectRatio="xMidYMid meet"
            ></svg>
          </div>

          <div id="mapSelectedLabel" class="map-selected-label">
            目前縣市：尚未選擇
          </div>
          <div class="map-note">
            點擊右側地圖上的縣市，也可以直接切換天氣。
          </div>
        </div>
      </div>
    </div>

    <!-- 今天概況浮動視窗（Modal） -->
    <div id="todayModal" class="modal-backdrop">
      <div class="modal-dialog">
        <button class="modal-close" type="button" aria-label="關閉">×</button>
        <div class="modal-title">
          <span class="emoji">🌤️</span>
          <span>今天概況</span>
        </div>
        <div id="modalContent" class="modal-text"></div>
        <button id="modalKnowBtn" class="modal-button">好，我知道了</button>
        <div class="modal-subtext">
          關閉後，下方彩色小卡會一直保留今天概況摘要。
        </div>
      </div>
    </div>

    <!-- D3 v3（沿用 letswrite 教學使用的版本） -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.min.js"></script>
    <script src="main.js"></script>
  </body>
</html>
